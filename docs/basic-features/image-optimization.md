---
description: Next.js поддерживает встроенную оптимизацию шрифтов, а также сторонние загрузчики для Imgix, Cloudinary и другие! Узнайте больше здесь.
---

# Компонент Image и оптимизация изображений

<details open>
  <summary><b>Примеры</b></summary>
  <ul>
    <li><a href="https://github.com/vercel/next.js/tree/canary/examples/image-component">Компонент Image</a></li>
  </ul>
</details>

Начиная с версии **10.0.0** Next.js имеет встроенный компонент Image и автоматическую оптимизацию изображений.

Встроенный в Next.js компонент Image [`next/image`](/docs/api-reference/next/image.md) - это ничто иное, как расширенное представление html-тега `<img>`, адаптированное под современные нужды web.

Автоматическая оптимизация картинок позволяет изменять размер, оптимизировать и предоставлять изображения в современных форматах, таких как [WebP](https://developer.mozilla.org/en-US/docs/Web/Media/Formats/Image_types)
(в тех случаях, когда браузер это поддерживает). Автоматическая оптимизация картинок позволяет избежать отправки больших изображений на устройства с маленькими экранами. Она также позволяет Next.js принимать
форматы изображений "будущего" и отдавать их в браузеры, которые это поддерживают.

Автоматическая оптимизация картинок работает с любым источником изображений. Даже если изображение хранится на внешнем ресурсе (например, в CMS), оно все равно может быть оптимизировано.

Вместо того, чтобы оптимизировать изображения во время сборки, Next.js оптимизирует изображения "на лету", по мере того, как пользователь их запрашивает. В сравнении с генераторами статичных сайтов или другими сборщиками и
решениями, ориентированными только на статичную работу, время вашей сборки в Next.js не вырастет, вне зависимости от того, 10 картинок или 10 миллионов картинок имеется в проекте.

По умолчанию изображения имеют ленивую загрузку. Это значит, что скорость загрузки страницы не будут замедлять те изображения, которые не помещаются в текущий экран. Изображения будут загружаться по мере прокрутки страницы,
когда они попадают в область просмотра.

Изображения всегда загружаются таким способом для того, чтобы избежать [Совокупной задержки разметки - Cumulative Layout Shift](https://web.dev/cls/), которая яваляется одним из важнейших параметров [(Core Web Vital](https://web.dev/vitals/)) в [поисковом ранжировании](https://webmasters.googleblog.com/2020/05/evaluating-page-experience.html) у Google.

## Компонент Image

Чтобы добавить изображение в ваше приложение, импортируйте компонент [`next/image`](/docs/api-reference/next/image.md):

```jsx
import Image from "next/image";

function Home() {
	return (
		<>
			<h1>Моя домашняя страница</h1>
			<Image
				src="/me.png"
				alt="Picture of the author"
				width={500}
				height={500}
			/>
			<p>Добро пожаловать на мою домашнюю страницу!</p>
		</>
	);
}

export default Home;
```

## Импорт изображений

Вы можете импортировать (`import`) изображения, которые имеются в вашем проекте. (Помните, что поддерживается только директива `import`, но не `require`)

В компонент изображения автоиатически добавляются пропсы `width`, `height`, и `blurDataURL`, альтернативный текст - `alt` добавляется отдельно, вручную.

```js
import Image from "next/image";
import profilePic from "../public/me.png";

function Home() {
	return (
		<>
			<h1>Моя домашняя страница</h1>
			<Image
				src={profilePic}
				alt="Picture of the author"
				// width={500} добавлено автоматически
				// height={500} добавлено автоматически
				// blurDataURL="data:..." добавлено автоматически
				// Опционально можно добавить размытый вариант изображения, чтобы показывать его во время загрузки
				// placeholder="blur"
			/>
			<p>Добро пожаловать на мою домашнюю страницу!</p>
		</>
	);
}
```

Для динамических изображений или изображений, находящихся на другом ресурсе, вам необходимо вручную указывать для них [`width`](/docs/api-reference/next/image#width), [`height`](/docs/api-reference/next/image#height) и [`blurDataURL`](/docs/api-reference/next/image#blurdataurl).

## Пропсы

Просмотр всех пропсов для компонента `next/image` [доступен здесь](/docs/api-reference/next/image.md)

## Конфигурация

Помимо имеющихся для компонента `next/image` [пропсов](/docs/api-reference/next/image.md), вы можете также настроить оптимизацию изображений в `next.config.js`.

### Домены

Чтобы включить оптимизацию для изображений, которые находятся на внешнем ресурсе, используйте абсолютный url в пропсе `src` для компонента Image.
Вместе с этим нужно добавить данный домен в список доменов (`domains`), для которых нужно проводить оптимизацию изображений. Это делается внутри `next.config.js`.
Это необходимо для того, чтобы предотвратить злоупотребление внешними ресурсами. Когда `loader` настроен на внешний ресурс, эта опция будет проигнорирована.

```js
module.exports = {
	images: {
		domains: ["example.com"],
	},
};
```

### Загрузчик (loader)

Если вместо встроенных в Next.js инструментов оптимизации изображений вы используете облачного провайдера, вы можете сконфигурировать загрузчик и префикс для ссылок.
Это позволит вам использовать относительные пути в `src` компонента Image и автоматически генерировать правильные абсолютные пути до изображений у провайдера.

```js
module.exports = {
	images: {
		loader: "imgix",
		path: "https://example.com/myaccount/",
	},
};
```

Следующие провайдеры для оптимизации изображений доступны из коробки:

- [Vercel](https://vercel.com): Работает автоматически, когда вы выкладываете проект на Vercel, не нужно никакой конфигурации. [Узнать больше](https://vercel.com/docs/next.js/image-optimization)
- [Imgix](https://www.imgix.com): `loader: 'imgix'`
- [Cloudinary](https://cloudinary.com): `loader: 'cloudinary'`
- [Akamai](https://www.akamai.com): `loader: 'akamai'`
- По умолчанию: Выполняется автоматически с командами `next dev`, `next start`, или с кастомным сервером

Если вам нужен другой провайдер для `next/image`, вы можете воспользоваться пропсом [`loader`](/docs/api-reference/next/image.md#loader).

> При использовании компонента [`next export`](/docs/advanced-features/static-html-export.md) не поддерживается загрузчик по умолчанию,
> если используется директива [`next export`](/docs/advanced-features/static-html-export.md). Однако другие опции загрузчика будут работать.

## Кеширование

Ниже описан алгоритм кеширования для [загрузчика](#loader) по умолчанию. С алгоритмами кеширования для остальных загрузчиков вы можете ознакомиться в документации их провайдеров.

Изображения оптимизируются динамически на каждый запрос и хранятся в директории `<distDir>/cache/images`. Оптимизированный файл будет отдаваться на последующие запросы до тех пор,
пока не истечет срок его хранения. Когда запрос отправляется по пути кешированного файла с истекшим сроком хранения, кешированный файл удаляется перед генерацией нового файла с последующим сохранением его в кеш.

Время хранения (expiration) (или чаще используемый максимальный возраст (Max Age)) определяются на сервере, в заголовке `Cache-Control`

Если в `Cache-Control` есть `s-maxage`, то его значение используется для указания максимального возраста. Если `s-maxage` не найден, то используется `max-age`.
Если же и `max-age` не был найден, то в качестве максимального возраста для запрашиваемого ресурса устанавливается значение в 60 секунд.

Вы можете настроить [`deviceSizes` (размеры устройств)](#device-sizes) и [`imageSizes` (размеры изображений)](#device-sizes)
для уменьшения общего количества возможных сгенерированных изображений.

## Расширенные настройки

Конфигурация, которая приведена ниже нужна для более сложных кейсов, но не для рядового использования. Если вы прибегните к этим настройкам, то перекроете ими любые изменения значени по умолчанию, в том числе для будущих обновлений Next.js.

### Размеры устройств (Device Sizes)

В некоторых случаях, когда вы знаете ширину экранов пользователей вашего сайта, вы можете создать список из этих значений, присвоив их свойству `deviceSizes`. Этот список будет использован для компонента `next/image`](/docs/api-reference/next/image.md), когда у него `layout="responsive"` или `layout="fill"`. В этом случае изображение подходящего размера будет отправлено на пользовательский девайс.

Если конфигурация не указана, используется значение по умолчанию, приведенное ниже.

```js
module.exports = {
	images: {
		deviceSizes: [640, 750, 828, 1080, 1200, 1920, 2048, 3840],
	},
};
```

### Размеры изображения

Вы можете создать список со значениям ширины изображения, присвоив их свойству `imageSizes`. Эти значения должны отличаться (как правило, в меньшую сторону) от тех, что использовались в `deviceSizes`, потому как эти массивы будут
конкатенированы. Значения из `imageSizes` будут использоваться для компонента `next/image`](/docs/api-reference/next/image.md), когда `layout="fixed"` или `layout="intrinsic"`.

Если конфигурация не указана, используется значение по умолчанию, приведенное ниже.

```js
module.exports = {
	images: {
		imageSizes: [16, 32, 48, 64, 96, 128, 256, 384],
	},
};
```

### Отключение статических импортов

Поведение по умолчанию позволяет вам импортировать статичные файлы, такие как `import icon from './icon.png` и потом передавать их в проп `src`.

В некоторых случаях вы можете захотеть отключить эту функцию, например, если она конфликтует с другими плагинами, которые предполагают иное поведение для импорта.

Вы можете отключить статический импорт изображений с помощью конфигурации, которая приведена ниже.

```js
module.exports = {
	images: {
		disableStaticImages: true,
	},
};
```

## Связанные темы

В контексте этой темы мы также рекомендуем ознакомиться с:

<div class="card">
  <a href="/docs/api-reference/next/image.md">
    <b>next/image</b>
    <small>Посмотреть доступные пропсы для компонента Image</small>
  </a>
</div>
